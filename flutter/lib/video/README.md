Ported from media-kit/media-kit-video